<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BurnedStream</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .row-scroll { display: flex; overflow-x: auto; gap: 1rem; scroll-behavior: smooth; }
    .row-scroll::-webkit-scrollbar { display: none; }
    .card-custom { min-width: 160px; flex-shrink: 0; transition: transform 0.3s ease; }
    .card-custom:hover { transform: scale(1.08); z-index: 10; }
  </style>
</head>
<body class="bg-gray-900 text-white">
  <!-- Navbar -->
  <nav class="navbar navbar-dark bg-black px-4 fixed w-full z-50">
    <a class="navbar-brand text-xl font-bold text-red-600" href="index.html">üî• BurnedStream</a>
    <form class="d-flex">
      <input id="search" class="form-control me-2 bg-dark text-white border-0" type="search" placeholder="Search...">
      <button class="btn btn-danger" type="button" onclick="searchContent()">Search</button>
    </form>
  </nav>

  <!-- Hero -->
  <section id="hero" class="relative h-[60vh] md:h-[80vh] flex items-center justify-center bg-black mt-[56px]">
    <img id="heroPoster" class="absolute inset-0 w-full h-full object-cover opacity-40">
    <div class="relative text-center px-4">
      <h1 id="heroTitle" class="text-3xl md:text-6xl font-bold mb-4 drop-shadow-lg"></h1>
      <p id="heroDesc" class="max-w-xl mx-auto text-sm md:text-lg mb-4"></p>
      <a id="heroBtn" href="#" class="btn btn-danger px-4">‚ñ∂ Watch</a>
    </div>
  </section>

  <!-- Sections -->
  <div class="container-fluid px-4 py-6">
    <h2 class="text-2xl font-bold mb-2">Movies</h2>
    <div id="moviesRow" class="row-scroll mb-6"></div>

    <h2 class="text-2xl font-bold mb-2">TV Series</h2>
    <div id="seriesRow" class="row-scroll mb-6"></div>

    <h2 class="text-2xl font-bold mb-2">All Titles</h2>
    <div id="allRow" class="row-scroll"></div>
  </div>

  <script>
    const API = "https://crew-auth.vercel.app/api";

    async function loadContent() {
      let [movies, series] = await Promise.all([
        axios.get(`${API}/content`),
        axios.get(`${API}/series`)
      ]);

      let allItems = [...movies.data, ...series.data];
      if (allItems.length) setHero(allItems[0]);

      renderRow("moviesRow", movies.data);
      renderRow("seriesRow", series.data);
      renderRow("allRow", allItems);
    }

    function setHero(item) {
      document.getElementById("heroPoster").src = item.poster;
      document.getElementById("heroTitle").innerText = item.title;
      document.getElementById("heroDesc").innerText = item.description?.substring(0, 120) || "";
      document.getElementById("heroBtn").href = `watch.html?type=${item.type}&id=${item._id}`;
    }

    function renderRow(rowId, items) {
      let row = document.getElementById(rowId);
      row.innerHTML = "";
      items.forEach(item => {
        let card = `
          <div class="card bg-dark text-white card-custom shadow-lg">
            <img src="${item.poster}" class="card-img-top h-64 object-cover" alt="${item.title}">
            <div class="card-body p-2">
              <h6 class="card-title text-truncate">${item.title}</h6>
              <p class="text-warning text-xs">‚≠ê ${item.rating || "N/A"}</p>
              <a href="watch.html?type=${item.type}&id=${item._id}" class="btn btn-danger btn-sm w-full">Watch</a>
            </div>
          </div>
        `;
        row.innerHTML += card;
      });
    }

    async function searchContent() {
      let q = document.getElementById("search").value.toLowerCase();
      let [movies, series] = await Promise.all([
        axios.get(`${API}/content`),
        axios.get(`${API}/series`)
      ]);
      let allItems = [...movies.data, ...series.data];
      let results = allItems.filter(i => i.title.toLowerCase().includes(q));
      renderRow("allRow", results);
    }

    loadContent();
  </script>
</body>
</html>
