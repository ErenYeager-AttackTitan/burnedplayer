<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Streaming Platform</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white">
  <!-- Navbar -->
  <nav class="navbar navbar-dark bg-dark px-4">
    <a class="navbar-brand text-xl font-bold" href="index.html">üé¨ BurnedStream</a>
    <form class="d-flex">
      <input id="search" class="form-control me-2" type="search" placeholder="Search..." aria-label="Search">
      <button class="btn btn-outline-light" type="button" onclick="searchContent()">Search</button>
    </form>
  </nav>

  <!-- Content -->
  <div class="container py-5">
    <h2 class="text-2xl font-bold mb-4">Movies & Series</h2>
    <div id="content" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"></div>
  </div>

  <script>
    const API = "https://crew-auth.vercel.app/api";

    async function loadContent() {
      let [movies, series] = await Promise.all([
        axios.get(`${API}/content`),
        axios.get(`${API}/series`)
      ]);

      let allItems = [...movies.data, ...series.data];
      displayContent(allItems);
    }

    function displayContent(items) {
      let container = document.getElementById("content");
      container.innerHTML = "";

      items.forEach(item => {
        let card = `
          <div class="card bg-dark text-white shadow-lg hover:scale-105 transition">
            <img src="${item.poster}" class="card-img-top h-60 object-cover" alt="${item.title}">
            <div class="card-body">
              <h5 class="card-title text-truncate">${item.title}</h5>
              <p class="card-text text-sm text-gray-400">${item.description?.substring(0, 80) || ""}...</p>
              <p class="text-warning">‚≠ê ${item.rating || "N/A"}</p>
              <a href="watch.html?slug=${item.slug}" class="btn btn-danger btn-sm">Watch</a>
            </div>
          </div>
        `;
        container.innerHTML += card;
      });
    }

    async function searchContent() {
      let query = document.getElementById("search").value.toLowerCase();
      let [movies, series] = await Promise.all([
        axios.get(`${API}/content`),
        axios.get(`${API}/series`)
      ]);
      let allItems = [...movies.data, ...series.data];
      let results = allItems.filter(i => i.title.toLowerCase().includes(query));
      displayContent(results);
    }

    loadContent();
  </script>
</body>
</html>
