<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Watch - BurnedStream</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white">
  <div class="container-fluid p-0">
    <div class="relative h-[70vh] w-full bg-black">
      <iframe id="player" class="w-full h-full" allowfullscreen></iframe>
    </div>
    <div class="p-4">
      <h1 id="title" class="text-3xl font-bold"></h1>
      <p id="desc" class="text-sm text-gray-300 my-2"></p>
      <p class="text-warning">⭐ <span id="rating"></span></p>
    </div>
  </div>

  <script>
    const API = "https://crew-auth.vercel.app/api";
    const params = new URLSearchParams(window.location.search);
    const slug = params.get("slug");

    async function loadVideo() {
      if (!slug) {
        document.body.innerHTML = "<h1 class='text-center mt-20'>❌ No video slug</h1>";
        return;
      }
      document.getElementById("player").src = `https://burnedplayer.pages.dev/player?v=${slug}`;

      // fetch details
      let [movies, series] = await Promise.all([
        axios.get(`${API}/content`),
        axios.get(`${API}/series`)
      ]);
      let all = [...movies.data, ...series.data];
      let item = all.find(i => i.slug === slug);
      if (item) {
        document.getElementById("title").innerText = item.title;
        document.getElementById("desc").innerText = item.description;
        document.getElementById("rating").innerText = item.rating || "N/A";
      }
    }

    loadVideo();
  </script>
</body>
</html>
